<%  
# this partial renders a tabnav, you can call it in your views with:
#   <%= tabnav :project % > (just the tabnav) 
# or, if you want a boxed tabnav:
#   <% tabnav :project do % >
#     your html here
#   <% end % >
# (remove the space between % and >, we don't want to mess up your brand new tabnav :-))
#
# you can pass render_tabnav a few options:
#   :generate_css => true|false #=> generates a default inline css for the tabnav, defaults to false
#   :html => aHash #=> sets html options for the tabnav's div (es :html => {:class=> 'myCssClass', :id=>'myCssId'}) 
#     
render_tabnav :schedule, :html => {:class => 'page_tabnav'} do 
  
  add_tab do |t|
    t.named _("Cédule journalière")
    t.links_to hash_for_daily_schedules_url
  end
  
  
  departments = Department.all
  multi_dept = departments.size > 1
  
  if multi_dept
    add_tab do |t|
      t.named "&nbsp;&nbsp;Planification:"
    end
  end
  
  Department.all.each do |department|
    add_tab do |t|
      t.named( multi_dept ? department : "Planification #{department}" )
      t.links_to hash_for_project_schedule_url(:grouped_by => 'foreman_id', :department_id => department.id, :user_id => nil)
      t.highlights_on lambda {
        params[:controller] == 'project_schedules' && params[:department_id].to_i == department.id && params[:grouped_by] != 'project_manager_id'
      }
    end
    
  end
  
  if current_account.tc?
    add_tab do |t|
      t.named "Chargé de projet"
      t.links_to hash_for_project_schedule_url(:grouped_by => 'project_manager_id', :department_id => nil, :user_id => 'contract')
      t.highlights_on lambda {
        params[:grouped_by] == 'project_manager_id'
      }
    end
  end
  
  if multi_dept
    add_tab do |t|
      t.named "&nbsp;&nbsp;Agenda:"
    end
  end
  
  Department.all.each do |department|
    add_tab do |t|
      t.named( multi_dept ? department : "Agenda #{department}" )
      t.links_to hash_for_service_programs_url(:department_id => department.id)
      t.highlights_on lambda {
        params[:controller] == 'service_programs' && (params[:department_id] == department.id)
      }
    end
  end
  
  add_tab do |t|
    t.named "&nbsp;"
  end
  
  add_tab do |t|
    t.named _("Équipes")
    t.links_to hash_for_teams_url
  end
  
end 
%>